This is still WIP (I might work on optimizations sometime)
